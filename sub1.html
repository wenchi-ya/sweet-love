<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>恋爱小游戏 ❤</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
      color: pink;
      text-align: center;
      font-family: 'Microsoft YaHei';
    }
    h1 {
      position: absolute;
      top: 20%;
      width: 100%;
      font-size: 3rem;
      animation: fade 3s infinite;
      z-index: 2;
    }
    @keyframes fade {
      0%,100% { opacity: 0; }
      50% { opacity: 1; }
    }
    canvas {
      position: fixed;
      top: 0; left: 0;
      z-index: 0;
    }
    /* 返回按钮 */
    .back-btn {
      position: absolute;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      background: rgba(255,105,180,0.8);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
      z-index: 3;
      text-decoration: none;
    }
    .back-btn:hover {
      background: rgba(255,50,120,1);
    }
    /* 游戏区 */
    #game {
      position: absolute;
      bottom: 80px;
      width: 100%;
      text-align: center;
      z-index: 2;
      color: white;
    }
    #score {
      font-size: 1.2rem;
      margin-bottom: 10px;
      display: block;
    }
    .heart {
      position: absolute;
      font-size: 24px;
      color: red;
      cursor: pointer;
      animation: fall linear;
    }
    @keyframes fall {
      from { top: -30px; }
      to { top: 100vh; }
    }
    /* 音乐按钮 */
    #musicBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(255,105,180,0.8);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 24px;
      color: white;
      cursor: pointer;
      z-index: 5;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      transition: background 0.3s;
    }
    #musicBtn:hover {
      background: rgba(255,50,120,1);
    }
  </style>
</head>
<body>
  <a href="index.html" class="back-btn">⬅ 返回</a>
  <h1 id="words">我爱你 ❤</h1>
  <canvas id="fireworks"></canvas>

  <!-- 游戏区 -->
  <div id="game">
    <span id="score">得分: 0</span>
    <p>点击掉落的 ❤ 获取分数！</p>
  </div>

  <!-- 背景音乐 -->
  <audio id="bgm" autoplay loop>
    <source src="music/head.mp3" type="audio/mp3">
    你的浏览器不支持 audio 标签。
  </audio>
  <button id="musicBtn">🔊</button>
  
  <script>
    // ========== 表白循环语句 ==========
    const msgs = ["亲爱的，你是我的唯一 ❤","遇见你是我一生最美的意外 💕","无论何时何地，我都爱你 💖"];
    let idx = 0;
    setInterval(()=>{
      document.getElementById("words").innerText = msgs[idx];
      idx = (idx+1)%msgs.length;
    },3000);

    // ========== 烟花动画 ==========
    const canvas = document.getElementById("fireworks");
    const ctx = canvas.getContext("2d");
    resize();
    window.addEventListener("resize", resize);

    let particles = [];
    function resize(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    function random(min,max){ return Math.random()*(max-min)+min; }
    function createFirework(){
      const x = random(0,canvas.width);
      const y = random(0,canvas.height/2);
      const color = `hsl(${random(0,360)},100%,60%)`;
      for(let i=0;i<100;i++){
        particles.push({
          x,y,
          angle: random(0,2*Math.PI),
          speed: random(1,5),
          life: 100,
          color
        });
      }
    }
    function loop(){
      ctx.fillStyle = "rgba(0,0,0,0.2)";
      ctx.fillRect(0,0,canvas.width,canvas.height);
      particles.forEach((p,i)=>{
        p.x += Math.cos(p.angle)*p.speed;
        p.y += Math.sin(p.angle)*p.speed;
        p.life--;
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x,p.y,2,2);
        if(p.life<=0) particles.splice(i,1);
      });
      requestAnimationFrame(loop);
    }
    setInterval(createFirework,1000);
    loop();

    // ========== 点击爱心小游戏 ==========
    let score = 0;
    function spawnHeart(){
      const heart = document.createElement("div");
      heart.className = "heart";
      heart.innerHTML = "❤";
      heart.style.left = Math.random()*90 + "vw";
      heart.style.top = "-30px";
      heart.style.animationDuration = (3+Math.random()*3)+"s";

      heart.addEventListener("click", ()=>{
        score++;
        document.getElementById("score").innerText = "得分: " + score;
        heart.remove();
      });

      document.body.appendChild(heart);

      setTimeout(()=>{ heart.remove(); },6000);
    }
    setInterval(spawnHeart, 1500);

    // ========== 音乐控制 ==========
    const bgm = document.getElementById("bgm");
    const musicBtn = document.getElementById("musicBtn");
    musicBtn.addEventListener("click", ()=>{
      if (bgm.paused) {
        bgm.play();
        musicBtn.textContent = "🔊";
      } else {
        bgm.pause();
        musicBtn.textContent = "🔇";
      }
    });
  </script>
</body>
</html>
